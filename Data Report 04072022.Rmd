---
title: "Data report"
author: "Angelina Venetto"
date: "3/31/2022"
output: html_document
---

```{r setup, include=FALSE}
install.packages("tidytuesdayR")\
(library)tidyverse::
```
```{r setup, include=FALSE}
library(tidytuesdayR)
library(tidyverse)
```

```{r}
chocolate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-18/chocolate.csv')
```
#This project aims to examine which country manufactures the highest rated chocolate in the last 5 years 
#Data was found here: https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-18/readme.md

```{r}
ggplot(chocolate) +
  aes(x = country_of_bean_origin,
      y = rating,
      fill = rating,
      color = rating) +
  geom_point() 
```
#Filtering data from the last 5 years, while dropping any data with out a rating. Also grouping by country
```{r}
chocolate_clean <- chocolate %>%
  select(year = review_date, country = company_location, rating = rating)
```
```{r}
rating <- "rating"
country <- "country"
year <- "year"
```
```{r}
chocolate_clean <- chocolate_clean %>% 
  filter(year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022)) %>%
#drop_na(rating, country, year)%>%
 group_by(country, year)%>%
  ungroup() %>%
  select(country, year, rating) %>%
  mutate(rating = mean(rating))%>%
  #making the data set wider
 # pivot_wider(names_from = country, year, values_from = rating)
  pivot_longer(
    cols = USA:Austria,
    names_to = c("country"),
    values_to = "rating"
  )
chocolate_clean
```
```{r}
ggplot(chocolate_clean) +
  aes(x = country,

      fill = country,
      color = country) +
  geom_bar() 
```